{"ast":null,"code":"import \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport \"core-js/modules/es.array.push.js\";\nimport Vcode from \"vue-puzzle-vcode\";\nimport NationalityList from '@/components/NationalityList';\nimport { getIdcode } from '@/API/common';\nimport { savePhone } from '@/API/user';\nexport default {\n  name: 'BindPhone',\n  components: {\n    NationalityList,\n    Vcode\n  },\n  data() {\n    return {\n      img1: require('@/assets/image/slider/1.png'),\n      img2: require('@/assets/image/slider/2.png'),\n      img3: require('@/assets/image/slider/3.png'),\n      img4: require('@/assets/image/slider/4.png'),\n      img5: require('@/assets/image/slider/5.png'),\n      triangleDown: require('@/assets/image/me/triangle_down.png'),\n      show: false,\n      pageDiaCode: false,\n      dialCode: localStorage.getItem('dialCode') || 1,\n      codeBtnTxt: this.$t('收取验证码'),\n      count: 60,\n      interval: null,\n      btnDisabled: false,\n      formData: {\n        phone: '',\n        verifcode: ''\n      }\n    };\n  },\n  methods: {\n    onClickLeft() {\n      this.$router.push({\n        path: '/Setting',\n        dir: 'left'\n      });\n    },\n    onSuccess() {\n      this.submitHandle();\n      this.show = false;\n    },\n    getName(params) {\n      if (!this.pageDiaCode) {\n        this.pageDiaCode = true;\n      } else {\n        this.dialCode = params[2];\n        localStorage.setItem('dialCode', this.dialCode);\n      }\n    },\n    openNational() {\n      this.$refs.controlChild.open();\n    },\n    getCode() {\n      if (this.formData.phone === '') {\n        _Toast(this.$t('请输入手机号'));\n        return;\n      } else {\n        const reg = /^[0-9]+[0-9]*$/;\n        if (!reg.test(this.formData.phone)) {\n          _Toast(this.$t('手机号格式有误'));\n          return;\n        }\n      }\n      _Toast.loading({\n        duration: 0,\n        message: this.$t('发送中'),\n        forbidClick: true\n      });\n      const params = {\n        target: `${this.dialCode} ${this.formData.phone}`\n      };\n      getIdcode(params).then(() => {\n        _Toast.success(this.$t('发送成功'));\n        this.timerFn();\n      }).catch(err => {\n        _Toast.clear();\n        // Toast.fail(err.msg)\n      });\n    },\n    timerFn() {\n      this.codeBtnTxt = `${this.$t('再次获取')} ${this.count} s`;\n      this.btnDisabled = true;\n      this.interval = setInterval(() => {\n        if (this.count === 1) {\n          this.count = 60;\n          this.codeBtnTxt = this.$t('再次获取');\n          this.btnDisabled = false;\n          clearInterval(this.interval);\n        } else {\n          this.count -= 1;\n          this.codeBtnTxt = `${this.$t('再次获取')} ${this.count} s`;\n        }\n      }, 1000);\n    },\n    submitVertify() {\n      if (this.formData.phone === '') {\n        _Toast(this.$t('请输入手机号'));\n        return;\n      } else {\n        const reg = /^[0-9]+[0-9]*$/;\n        if (!reg.test(this.formData.phone)) {\n          _Toast(this.$t('手机号格式有误'));\n          return;\n        }\n      }\n      if (this.formData.verifcode === '') {\n        _Toast(this.$t('请输入验证码'));\n        return;\n      }\n      this.show = true;\n    },\n    submitHandle() {\n      _Toast.loading({\n        duration: 0,\n        message: this.$t('提交中'),\n        forbidClick: true\n      });\n      const params = {\n        ...this.formData,\n        phone: `${this.dialCode} ${this.formData.phone}`\n      };\n      savePhone(params).then(async () => {\n        _Toast.success(this.$t('绑定成功'));\n        await this.$store.dispatch('getUserInfo');\n        this.onClickLeft();\n      }).catch(err => {\n        _Toast.clear();\n        // Toast.fail(err.msg)\n      });\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}