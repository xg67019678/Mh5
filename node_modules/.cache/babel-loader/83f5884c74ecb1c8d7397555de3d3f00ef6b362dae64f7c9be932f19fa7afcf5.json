{"ast":null,"code":"import \"vant/es/icon/style\";\nimport _Icon from \"vant/es/icon\";\nimport \"vant/es/badge/style\";\nimport _Badge from \"vant/es/badge\";\nimport \"vant/es/number-keyboard/style\";\nimport _NumberKeyboard from \"vant/es/number-keyboard\";\nimport \"vant/es/password-input/style\";\nimport _PasswordInput from \"vant/es/password-input\";\nimport \"vant/es/overlay/style\";\nimport _Overlay from \"vant/es/overlay\";\nimport \"vant/es/dialog/style\";\nimport _Dialog from \"vant/es/dialog\";\nimport \"vant/es/loading/style\";\nimport _loading from \"vant/es/loading\";\nimport \"vant/es/image/style\";\nimport _Image from \"vant/es/image\";\nimport \"vant/es/skeleton/style\";\nimport _Skeleton from \"vant/es/skeleton\";\nimport \"vant/es/notice-bar/style\";\nimport _NoticeBar from \"vant/es/notice-bar\";\nimport \"vant/es/swipe/style\";\nimport _Swipe from \"vant/es/swipe\";\nimport \"vant/es/swipe-item/style\";\nimport _SwipeItem from \"vant/es/swipe-item\";\nimport \"vant/es/search/style\";\nimport _Search from \"vant/es/search\"; // import HeahNavigation from \"@/components/HeahNavigation\"\nimport \"core-js/modules/es.array.push.js\";\nimport { shouyexinxi_post, huoquyue_post } from \"@/API/user\";\nimport { apiQueryMessages, apiUnreadSystemMessage } from \"@/API/common\";\nimport { apiGetNewGoods, apiGetRecommendGoods } from '@/API/home';\nimport Footer from '@/components/Footer';\nimport FloatingVideo from '@/components/FloatingVideo';\nimport { home_index, home_category, apiGetActivity, home_sellerGoods, getSellerList, apiGetBannerList } from \"@/API/home\";\n\n// import { Skeleton } from \"vant\";\nimport { priceFormat, priceFormatInt, isLogin } from \"@/utils/utis\";\nexport default {\n  name: \"HomePage\",\n  components: {\n    // HeahNavigation,\n    Footer,\n    FloatingVideo,\n    [_Search.name]: _Search,\n    [_SwipeItem.name]: _SwipeItem,\n    [_Swipe.name]: _Swipe,\n    [_NoticeBar.name]: _NoticeBar,\n    [_Skeleton.name]: _Skeleton,\n    [_Image.name]: _Image,\n    [_loading.name]: _loading,\n    [_Dialog.Component.name]: _Dialog.Component,\n    [_Overlay.name]: _Overlay,\n    [_PasswordInput.name]: _PasswordInput,\n    [_NumberKeyboard.name]: _NumberKeyboard,\n    [_Badge.name]: _Badge,\n    [_Icon.name]: _Icon\n  },\n  created() {\n    this.init();\n    const code = this.$route.query.code;\n    if (code) {\n      sessionStorage.setItem('ac_code', code);\n    }\n  },\n  data() {\n    return {\n      priceFormat,\n      priceFormatInt,\n      isShelves: !process.env.VUE_APP_PUT_ON_SHELVES,\n      isChristmas: process.env?.VUE_APP_IS_CHRISTMAS,\n      itemName: process.env.VUE_APP_ITEM_NAME,\n      isPutApp: process.env.VUE_APP_PUT_ON_SHELVES,\n      itemData: this.$store.state.multiItem[process.env.VUE_APP_ITEM_NAME],\n      isAr: localStorage.getItem(\"lang\") == \"ar\",\n      isApp: !window?.plus ? true : false,\n      isShowTopBtn: false,\n      msgNum: 0,\n      //未读消息数量\n      current: 0,\n      //product index\n      searchValue: \"\",\n      gundongtongzhi: \"\",\n      banner: [],\n      vipData: [],\n      lotteryShow: false,\n      lotteryPath: \"\",\n      show: false,\n      showNotify: !!localStorage.getItem('sellerId'),\n      searchIcon: require(\"@/assets/image/index/sousuo.png\"),\n      vip_zhifu_data: {},\n      zijin: {},\n      showKeyboard: true,\n      snow_background: null,\n      show1: false,\n      dailyNewArrivalList: [],\n      //新品\n      index_homeProject: [],\n      index_homeProject_index: 0,\n      bonus: \"\",\n      bonus_show: false,\n      recomendedStoreShopList: [],\n      recomendedStoreProductList: [],\n      productList: [],\n      //推荐\n      categoryList: [],\n      //分类\n      prodctPage: 1,\n      //推荐轮播页数\n      queryMessages: 0,\n      // 未读消息\n      time: null,\n      scrollTop: 0,\n      swiperOptions: {\n        slidesPerView: 3.5,\n        autoplay: {\n          delay: 3500000,\n          disableOnInteraction: false\n        }\n      },\n      swiperOptions2: {\n        loop: true,\n        // slidesPerView: 3.5,\n        autoplay: {\n          delay: 3500,\n          disableOnInteraction: false\n        }\n      },\n      loading: {\n        banner: true,\n        list: true,\n        product: true,\n        newest: true,\n        shop: true\n      },\n      isCn: localStorage.getItem('lang') === 'cn',\n      topBgColor: 'transparent'\n    };\n  },\n  mounted() {\n    // this.scrollTop = sessionStorage.getItem(\"scrollTopCount\") || 0;\n    // this.$nextTick(() => {\n    //     console.log(`scrollTopCount ::->`, +this.scrollTop);\n    //     window.scrollTo(0, +this.scrollTop);\n    // })\n    setTimeout(() => {\n      window.addEventListener(\"scroll\", this.handleScroll);\n    }, 1000);\n    // const { Snow, Mod } = SnowFalls;\n    // setTimeout(() => {\n    //     // 实例化Snow类\n    //     new Snow({\n    //         // 要添加动画的容器\n    //         view: this.$refs.snow_background,\n    //         snowflakeTextureSrcs: [\n    //             require(\"@/assets/image/snow.svg\"),\n    //         ],\n    //         snowflakeSize: [10, 6],\n    //         graphicsRotation: [3, 0],\n    //         // 加载需要的功能模块\n    //         modules: [\n    //             // 载入风力模块，雪花将受风力影响\n    //             new Mod.Wind(),\n    //             // 载入元素积雪效果，使用传入的css类名的元素将产生积雪效果\n    //             // 默认每个元素的积雪数量为当前元素的宽度值，如果当前总积雪数量超过了屏幕里存在的最大的雪花粒子数量，将不在产生下雪效果，请提高snowflakeNum的值解决，过多的边界将产生严重的性能影响\n\n    //             // new Mod.EleBorder(\"border\"),\n    //         ],\n    //         // 屏幕里存在的最大的雪花粒子数量, 默认200。当maxRenderSnow为false时，屏幕中渲染的粒子数量和帧率有关，一般不超过200个\n    //         snowflakeNum: 200,\n    //     });\n    // }, 1000)\n  },\n  computed: {\n    audioPlay() {\n      return this.$store.state.app.audioPlay;\n    },\n    notifyIcon() {\n      if (this.isChristmas) {\n        if (this.topBgColor == 'transparent') {\n          return require(`@/assets/christmas/tongzhi.svg`);\n        } else {\n          // return require(`@/assets/image/index/tongzhi.png`)\n          return require(`@/assets/christmas/tongzhi.svg`);\n        }\n      } else {\n        return require(`@/assets/image/index/tongzhi.png`);\n      }\n    },\n    logo() {\n      if (this.itemName == 'EShop' && this.isChristmas) {\n        return require(`@/assets/${process.env.VUE_APP_ITEM_NAME}/logo.${this.$store.state.multiItem[process.env.VUE_APP_ITEM_NAME].suffix}`);\n      }\n      if (['AntMall', 'INT Overstock', 'Shop2u', 'TikTokMall', 'SM-wholesaleShop', 'Laz', 'Iceland', 'TikTok-Wholesale', 'SIMON', 'TEXM', 'Alibaba-wholesales'].includes(this.itemName) && this.isChristmas) {\n        return require(`@/assets/${process.env.VUE_APP_ITEM_NAME}/logo2.${this.$store.state.multiItem[process.env.VUE_APP_ITEM_NAME].suffix}`);\n      }\n      return require(`@/assets/${process.env.VUE_APP_ITEM_NAME}/logo.${this.$store.state.multiItem[process.env.VUE_APP_ITEM_NAME].suffix}`);\n    },\n    classOption() {\n      return {\n        step: 0.5,\n        // 数值越大速度滚动越快\n        limitMoveNum: 8,\n        // 开始无缝滚动的数据量 this.dataList.length\n        hoverStop: true,\n        // 是否开启鼠标悬停stop\n        direction: 0,\n        // 0向下 1向上 2向左 3向右\n        openWatch: true,\n        // 开启数据实时监控刷新dom\n        singleHeight: 0,\n        // 单步运动停止的高度(默认值0是无缝不停止的滚动) direction => 0/1\n        singleWidth: 0,\n        // 单步运动停止的宽度(默认值0是无缝不停止的滚动) direction => 2/3\n        waitTime: 1000 // 单步运动停止的时间(默认值1000ms)\n      };\n    },\n    buttonStyle() {\n      if (this.itemName === 'TikTokMall') {\n        return {\n          background: '#000000',\n          color: '#fff'\n        };\n      }\n    },\n    languageIcon() {\n      const language = localStorage.getItem('lang') || \"en\";\n      if (language == 'en-US' || language == '\"en-US\"') {\n        language = 'en';\n      } else if (language == 'zh-CN' || language == \"'zh-CN'\") {\n        language = 'cn';\n      } else if (language == 'zh-TW' || language == \"'zh-TW'\") {\n        language = 'tw';\n      }\n      const icon = {\n        \"cn\": require(\"@/assets/image/language/cn.png\"),\n        \"en\": require(\"@/assets/image/language/usa.png\"),\n        \"tw\": require(\"@/assets/image/language/tw.png\"),\n        \"de\": require(\"@/assets/image/language/de.png\"),\n        \"ja\": require(\"@/assets/image/language/ja.png\"),\n        \"ms\": require(\"@/assets/image/language/ms.png\"),\n        \"th\": require(\"@/assets/image/language/th.png\"),\n        \"pt\": require(\"@/assets/image/language/pt.png\"),\n        \"es\": require(\"@/assets/image/language/es.png\"),\n        \"ru\": require(\"@/assets/image/language/ru.png\"),\n        \"el\": require(\"@/assets/image/language/el.png\"),\n        \"it\": require(\"@/assets/image/language/it.png\"),\n        \"tr\": require(\"@/assets/image/language/tr.png\"),\n        \"af\": require(\"@/assets/image/language/af.png\"),\n        \"fr\": require(\"@/assets/image/language/fr.png\"),\n        \"ko\": require(\"@/assets/image/language/ko.png\"),\n        \"ph\": require(\"@/assets/image/language/ph.png\"),\n        \"ar\": require(\"@/assets/image/language/ar.png\"),\n        \"vi\": require(\"@/assets/image/language/vi.png\"),\n        \"hi\": require(\"@/assets/image/language/hi.png\"),\n        \"id\": require(\"@/assets/image/language/id.png\")\n      };\n      return language ? icon[language] : icon['en'];\n    }\n  },\n  methods: {\n    // 获取当前活动信息\n    async requestActivity() {\n      const res = await apiGetActivity();\n      const langParam = `lang=${localStorage.getItem('lang')}&token=${localStorage.getItem('token')}`;\n      if (!res?.detailUrl) return;\n      this.lotteryPath = `${res.detailUrl}${res.detailUrl.includes('?') ? '&' : '?'}${langParam}`;\n      this.lotteryShow = !!res.detailUrl;\n    },\n    handleLotteryJump() {\n      if (window.plus) {\n        window.plus.runtime.openURL(encodeURI(this.lotteryPath + '&wt=app'));\n      } else {\n        location.href = this.lotteryPath;\n      }\n    },\n    information() {\n      if (!isLogin()) {\n        // Dialog.confirm({\n        //     title: this.$t(\"您还未登录\"),\n        //     message: this.$t(\"是否跳转到登录页面\"),\n        //     confirmButtonText: this.$t(\"确认\"),\n        //     cancelButtonText: this.$t(\"取消\"),\n        // }).then(() => {\n        //     this.$router.push(\"/login\");\n        // });\n        this.$notifyWarn(this.$t(\"请先登录\"));\n        this.$router.push(\"/login\");\n      } else {\n        //   this.$router.push(\"/information\");\n        this.$router.push(\"/message/list\");\n      }\n    },\n    async init() {\n      this.requestBanner();\n      this.requireRecommendNew();\n      this.requestHomeCategory();\n      // this.home_sellerGoods();\n      this.home_SellerList();\n      if (isLogin()) {\n        // 查询未读消息\n        this.getMessageNum();\n        this.time = setInterval(() => {\n          this.getMessageNum();\n        }, 10000);\n      }\n      // 活动\n      if (['EShop', 'Shop2u', 'TikTokMall', 'TikTok-Wholesale'].includes(this.itemName)) {\n        this.requestActivity();\n      }\n    },\n    async getMessageNum() {\n      this.queryMessages = await apiQueryMessages({\n        loginType: 'user'\n      });\n      apiUnreadSystemMessage({\n        type: 3,\n        module: '0'\n      }).then(res => {\n        this.queryMessages = +this.queryMessages + +res.count;\n      });\n    },\n    // 获取推荐/新品\n    async requireRecommendNew() {\n      /**\n       * type 0:每日新品 1:推荐产品 2:热销产品\n       */\n      if (sessionStorage.getItem(\"index_recomendedStoreProductList\")) {\n        this.recomendedStoreProductList = JSON.parse(sessionStorage.getItem(\"index_recomendedStoreProductList\"));\n        this.loading.product = false;\n      }\n      if (sessionStorage.getItem(\"index_dailyNewArrivalList\")) {\n        this.dailyNewArrivalList = JSON.parse(sessionStorage.getItem(\"index_dailyNewArrivalList\"));\n        this.loading.newest = false;\n      }\n      if (sessionStorage.getItem(\"index_productList\")) {\n        this.productList = JSON.parse(sessionStorage.getItem(\"index_productList\"));\n        this.prodctPage = Math.ceil(this.productList.length / 4);\n        this.loading.product = false;\n      }\n      const [recommendRes, dailyNewArrivalRes, recomendedStoreProductRes] = await Promise.all([apiGetNewGoods({\n        pageNum: 1,\n        pageSize: 24,\n        type: 1\n      }), apiGetNewGoods({\n        pageNum: 1,\n        pageSize: 24,\n        type: 0\n      }), apiGetNewGoods({\n        pageNum: 1,\n        pageSize: 24,\n        type: 2\n      })]);\n      this.productList = recommendRes.result;\n      this.prodctPage = Math.ceil(this.productList.length / 4);\n      this.loading.product = false;\n      this.dailyNewArrivalList = [...dailyNewArrivalRes.result, ...dailyNewArrivalRes.result];\n      this.loading.newest = false;\n      this.recomendedStoreProductList = recomendedStoreProductRes.result;\n      sessionStorage.setItem(\"index_productList\", JSON.stringify(this.productList));\n      sessionStorage.setItem(\"index_dailyNewArrivalList\", JSON.stringify(this.dailyNewArrivalList));\n      sessionStorage.setItem(\"index_recomendedStoreProductList\", JSON.stringify(this.recomendedStoreProductList));\n    },\n    async requestHomeCategory() {\n      if (sessionStorage.getItem(\"index_categoryList\")) {\n        this.categoryList = JSON.parse(sessionStorage.getItem(\"index_categoryList\"));\n        this.loading.list = false;\n      }\n      const {\n        pageList\n      } = await apiGetRecommendGoods({\n        pageNum: 1,\n        pageSize: 20\n      });\n      this.categoryList = pageList;\n      this.loading.list = false;\n      sessionStorage.setItem(\"index_categoryList\", JSON.stringify(this.categoryList));\n    },\n    handleBannerJump(item) {\n      if (window.plus) {\n        window.plus.runtime.openURL(encodeURI(item.link + '?wt=app'));\n      } else {\n        window.open(item.link);\n      }\n    },\n    handleDownload(n) {\n      if (this.itemName == 'Shop2u') {\n        if (n == 0) {\n          window.open('https://play.google.com/store/apps/details?id=com.commerce.app');\n        } else {\n          window.open('https://apps.apple.com/my/app/shop2u/id6448880380');\n        }\n      }\n      window.open(location.origin + \"/app.html?r=\" + Math.random());\n    },\n    // banner\n    async requestBanner() {\n      if (this.itemName == 'INT Overstock') {\n        // this.banner = result\n        if (localStorage.getItem('lang') === 'cn') {\n          this.banner.unshift({\n            imgUrl: require('@/assets/image/int-banner-cn.jpg'),\n            link: 'javascript:;'\n          });\n        } else {\n          this.banner.unshift({\n            imgUrl: require('@/assets/image/int-banner-en.jpg'),\n            link: 'javascript:;'\n          });\n        }\n        this.loading.banner = false;\n        return;\n      }\n      if (sessionStorage.getItem('index_banner')) {\n        this.banner = JSON.parse(sessionStorage.getItem('index_banner'));\n        this.loading.banner = false;\n      }\n      try {\n        const {\n          result\n        } = await apiGetBannerList({\n          type: 'h5',\n          pageNum: 1,\n          pageSize: 10\n        });\n        if (result.length === 0) {\n          this.banner = [{\n            imgUrl: require('@/assets/image/index/banner0.png')\n          }, {\n            imgUrl: require('@/assets/image/index/banner1.jpg')\n          }, {\n            imgUrl: require('@/assets/image/index/banner2.png')\n          }];\n        } else {\n          this.banner = result;\n        }\n      } catch (error) {\n        this.banner = [{\n          imgUrl: require('@/assets/image/index/banner0.png')\n        }, {\n          imgUrl: require('@/assets/image/index/banner1.jpg')\n        }, {\n          imgUrl: require('@/assets/image/index/banner2.png')\n        }];\n      }\n      sessionStorage.setItem('index_banner', JSON.stringify(this.banner));\n      const Image = document.createElement('img');\n      Image.src = this.banner[0].imgUrl;\n      Image.onload = () => this.loading.banner = false;\n    },\n    home_SellerList() {\n      if (sessionStorage.getItem('index_recomendedStoreShopList')) {\n        this.recomendedStoreShopList = JSON.parse(sessionStorage.getItem('index_recomendedStoreShopList'));\n        this.loading.shop = false;\n      }\n      let dataJson = {\n        pageNum: 1,\n        pageSize: 5,\n        isRec: 1\n      };\n      getSellerList(dataJson).then(res => {\n        this.recomendedStoreShopList = res.pageList;\n        this.loading.shop = false;\n        sessionStorage.setItem(\"index_recomendedStoreShopList\", JSON.stringify(this.recomendedStoreShopList));\n      });\n    },\n    home_sellerGoods() {\n      let data1 = {\n        recTime: Date.now()\n      };\n      home_sellerGoods(data1).then(res => {\n        //推荐产品\n        this.productList = res.pageList;\n        this.loading.product = false;\n        this.prodctPage = this.productList.length > 0 && Math.ceil(this.productList.length / 4);\n      });\n      let data2 = {\n        newTime: Date.now()\n      };\n      home_sellerGoods(data2).then(res => {\n        //新品推荐\n        this.dailyNewArrivalList = res.pageList;\n        this.loading.newest = false;\n      });\n      home_sellerGoods({}).then(res => {\n        //商品底部\n        this.recomendedStoreProductList = res.pageList;\n      });\n    },\n    touzi2() {\n      this.$router.push(\"/invest\");\n      location.reload();\n    },\n    touzi(e) {\n      document.body.scrollTop = 0;\n      // firefox\n      document.documentElement.scrollTop = 0;\n      this.$router.push(\"/ProductDetails?projectId=\" + e);\n    },\n    shouyexinxi() {\n      shouyexinxi_post({}).then(res => {\n        this.gundongtongzhi = res.announcement.toString();\n        this.banner = res.banner;\n        this.vipData = res.vip_level;\n      });\n    },\n    handleToTop() {\n      scrollTo({\n        top: 0,\n        left: 0,\n        behavior: 'smooth'\n      });\n    },\n    onClickLeft() {},\n    onClickRight() {},\n    huoquyue() {\n      huoquyue_post({}).then(res => {\n        console.log(res);\n        this.zijin = res;\n      });\n    },\n    vip_zhifu_list(e) {\n      this.show = true;\n      this.vip_zhifu_data = e;\n    },\n    kefutiaozhuan() {\n      var url = \"https://ld.ebvsjbv.site/chat/#/customerServiceH5?lang=\" + this.$i18n.locale;\n      if (localStorage.getItem(\"token\")) {\n        url += \"&token=\" + localStorage.getItem(\"token\");\n      }\n      window.location.href = url;\n    },\n    //监听product轮播index\n    handleChangeSwiper(index) {\n      this.current = index;\n    },\n    checkActive(index) {\n      return index === this.current; // current为监听的轮播index\n    },\n    //跳转商铺\n    jumpShop(item) {\n      sessionStorage.removeItem(\"shopState\");\n      this.$router.push(`/shop?sellerId=${item.id}&index=0`);\n    },\n    //跳转商品详情\n    openProduct(item) {\n      this.$router.push(\"/CommodityDetails?sellerGoodsId=\" + item.id);\n    },\n    //跳转分类商品\n    openClass(item) {\n      sessionStorage.removeItem(\"classificationState\");\n      const query = {\n        categoryId: item.categoryId,\n        className: item.name\n      };\n      this.$router.push({\n        path: \"/Classification\",\n        query\n      });\n    },\n    // 记录滚动条位置\n    handleScroll() {\n      if (this.isChristmas && this.scrollTop > 1) {\n        this.topBgColor = `#152840 url(${require('@/assets/christmas/bbg.png')}) no-repeat center / 100% 100%`;\n        // this.topBgColor =  `#152840`\n      } else {\n        this.topBgColor = 'transparent';\n      }\n      this.scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\n      this.isShowTopBtn = this.scrollTop > 500;\n    }\n  },\n  beforeDestroy() {\n    window.removeEventListener('scroll', this.handleScroll);\n    sessionStorage.setItem('scrollTopCount', this.scrollTop);\n    clearInterval(this.time);\n  },\n  watch: {\n    $route: {\n      handler: function (to, form) {\n        if (form.path == '/language') {\n          this.init();\n        }\n      },\n      deep: true\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}