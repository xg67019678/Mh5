{"ast":null,"code":"import \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport _Option2 from \"element-ui/lib/theme-chalk/option.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Option from \"element-ui/lib/option\";\nimport _Select2 from \"element-ui/lib/theme-chalk/select.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Select from \"element-ui/lib/select\";\nimport \"vant/es/uploader/style\";\nimport _Uploader from \"vant/es/uploader\";\nimport _Input2 from \"element-ui/lib/theme-chalk/input.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Input from \"element-ui/lib/input\";\nimport _FormItem2 from \"element-ui/lib/theme-chalk/form-item.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _FormItem from \"element-ui/lib/form-item\";\nimport _Form2 from \"element-ui/lib/theme-chalk/form.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Form from \"element-ui/lib/form\";\nimport \"vant/es/button/style\";\nimport _Button from \"vant/es/button\";\nimport \"vant/es/checkbox/style\";\nimport _Checkbox from \"vant/es/checkbox\";\nimport \"vant/es/popup/style\";\nimport _Popup from \"vant/es/popup\";\nimport _Dropdown2 from \"element-ui/lib/theme-chalk/dropdown.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Dropdown from \"element-ui/lib/dropdown\";\nimport _DropdownItem2 from \"element-ui/lib/theme-chalk/dropdown-item.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _DropdownItem from \"element-ui/lib/dropdown-item\";\nimport _DropdownMenu2 from \"element-ui/lib/theme-chalk/dropdown-menu.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _DropdownMenu from \"element-ui/lib/dropdown-menu\";\nimport \"core-js/modules/es.array.push.js\";\nimport { mapGetters, mapMutations } from \"vuex\";\nimport { uploadimg } from \"@/API/commodity\";\nimport { huoquyue_post, shifoushzhi_zijinmima_post } from \"@/API/user\";\nimport { apiLoanRepayForward, apiLoanPay } from '@/API/loan';\nimport EnterPassword from \"@/components/EnterPassword/index.vue\";\nimport NationalityList from '@/components/NationalityList';\nexport default {\n  name: \"merchantSettled\",\n  data() {\n    return {\n      mainColor: process.env.VUE_APP_MAIN_COLOR,\n      screenWidth: document.body.clientWidth,\n      uploadCheckIndex: 1,\n      areaCode: 1,\n      pwtStatus: false,\n      ruleForm: {\n        loanMethod: '',\n        term: '',\n        name: '',\n        idimg_1: '',\n        idimg_2: '',\n        idimg_3: '',\n        idname: '身份证',\n        interestRate: '2%',\n        nationality: '',\n        sellerImg: '',\n        username: '',\n        amount: ''\n      },\n      labelPosition: 'top',\n      isCode: true,\n      rules: {\n        // days: [\n        //     { required: true, message: this.$t('请输入贷款天数'), trigger: 'blur' },\n        // ],\n        // interestRate: [\n        //     { required: true, message: this.$t('请输入贷款利率'), trigger: 'blur' },\n        // ],\n        // name: [\n        //     { required: true, message: this.$t('请输入真实姓名'), trigger: 'blur' },\n        // ],\n        // loanMethod: [\n        //     { required: true, message: this.$t('请输入放款金额'), trigger: 'blur' },\n        // ],\n        amount: [{\n          required: true,\n          message: this.$t('请输入金额'),\n          trigger: 'blur'\n        }]\n      },\n      fileList1: [],\n      fileList2: [],\n      fileList3: [],\n      fileList4: [],\n      CountryList: [{\n        label: '中国',\n        value: 'cn',\n        icon: require('@/assets/image/language/cn.png')\n      }],\n      tabList: [this.$t('电子邮箱'), this.$t('手机号')],\n      tabIndex: 0,\n      lang: [{\n        title: '简体中文',\n        key: 'cn',\n        icon: require('@/assets/image/language/cn.png')\n      }, {\n        title: 'English',\n        key: 'en',\n        icon: require('@/assets/image/language/usa.png')\n      }, {\n        title: '繁体中文',\n        key: 'tw',\n        icon: require('@/assets/image/language/tw.png')\n      }],\n      pageDiaCode: true\n    };\n  },\n  computed: {\n    languageIcon() {\n      const language = this.$store.getters.language || 'tw';\n      const icon = {\n        'cn': require('@/assets/image/language/cn.png'),\n        'en': require('@/assets/image/language/usa.png'),\n        'tw': require('@/assets/image/language/tw.png')\n      };\n      return icon[language];\n    },\n    ...mapGetters({\n      activeLang: 'language'\n    })\n  },\n  components: {\n    EnterPassword,\n    NationalityList,\n    [_DropdownMenu.name]: _DropdownMenu,\n    [_DropdownItem.name]: _DropdownItem,\n    [_Dropdown.name]: _Dropdown,\n    [_Popup.name]: _Popup,\n    [_Checkbox.name]: _Checkbox,\n    [_Button.name]: _Button,\n    [_Form.name]: _Form,\n    [_FormItem.name]: _FormItem,\n    [_Input.name]: _Input,\n    [_Uploader.name]: _Uploader,\n    [_Select.name]: _Select,\n    [_Option.name]: _Option,\n    [_Toast.name]: _Toast\n  },\n  created() {\n    if (this.screenWidth >= 500) {\n      this.labelPosition = \"left\";\n    } else {\n      this.labelPosition = \"top\";\n    }\n    this.requireLoanRepayForward();\n  },\n  watch: {\n    tabIndex(val, old) {\n      if (val === old) return;\n      this.ruleForm.username = '';\n    }\n  },\n  methods: {\n    // 还款前信息\n    async requireLoanRepayForward() {\n      const res = await apiLoanRepayForward({\n        creditId: this.$route.query.creditId\n      });\n      this.ruleForm.name = res.realName;\n      this.ruleForm.days = res.alreadyCreditDays;\n      this.ruleForm.interestRate = res.creditRate * 100 + '%';\n      this.ruleForm.loanMethod = `${this.$t('账户余额')}: ${res.accountAmount}`;\n      this.ruleForm.amount = res.estimatePayment;\n    },\n    // 还款请求\n    async requireLoanPay(safeword) {\n      const res = await apiLoanPay({\n        creditId: this.$route.query.creditId,\n        safeword\n      });\n      this.$router.go(-1);\n      this.$notify(this.$t('还款成功'), 'success');\n    },\n    getPassword(value) {\n      this.requireLoanPay(value);\n    },\n    // 裁剪\n    handleCutting() {\n      this.isCutting = true;\n    },\n    // 取消\n    handleCancel() {\n      this.isCutting = false;\n      this.fileList1 = [];\n    },\n    // 上传\n    handleUpload(data) {\n      let fileOfBlob = new File([data], \"logo.png\"); // 重命名\n      _Toast.loading({\n        duration: 0,\n        message: this.$t('上传中'),\n        forbidClick: true\n      });\n      let formData = new FormData(); //通过formdata上传\n      formData.append('file', fileOfBlob);\n      formData.append('moduleName', 'selle');\n      uploadimg(formData).then(data => {\n        this.ruleForm.sellerImg = data;\n        this.isCutting = false;\n        this.fileList1[0].content = data;\n        // this.fileList1[0].file=fileOfBlob\n      }).finally(() => {\n        _Toast.clear();\n      });\n    },\n    // 裁剪\n    handleCropData(data) {\n      console.log('裁剪数据');\n      console.log(data);\n    },\n    ...mapMutations(['setLanguage']),\n    handleSetLang(index) {\n      console.log(index);\n      // 设置i18n.locale 组件库会按照上面的配置使用对应的文案文件\n      this.$i18n.locale = this.lang[index].key;\n      // // 提交mutations\n      this.setLanguage(this.lang[index].key);\n    },\n    handleDelete(index) {\n      this[`fileList${index}`] = [];\n    },\n    sellerRegister() {\n      this.$refs['ruleForm'].validate(valid => {\n        if (valid) {\n          // this.requireLoanPay()\n          this.handlePay();\n          // this.pwtStatus = true\n        } else {\n          return false;\n        }\n      });\n    },\n    handlePay() {\n      shifoushzhi_zijinmima_post({}).then(res => {\n        if (res.safeword == 1) {\n          this.pwtStatus = true;\n        } else {\n          this.$router.push({\n            path: \"/FundPasswordSettings\"\n          });\n        }\n      });\n    },\n    openNationality(index) {\n      if (index === 1) {\n        this.isCode = true;\n      } else {\n        this.isCode = false;\n      }\n      this.$refs.controlChild.open();\n    },\n    getName(params) {\n      if (this.isCode) {\n        this.areaCode = params[2];\n      } else {\n        this.ruleForm.nationality = params[0];\n      }\n    },\n    //文件上传\n    afterRead1(file) {\n      this.imgFile = file.content;\n      this.isCutting = true;\n      // Toast.loading({\n      //   duration: 0,\n      //   message: this.$t('上传中'),\n      //   forbidClick: true,\n      // })\n      // console.log(file)\n      // let formData = new FormData();//通过formdata上传\n      // formData.append('file', file.file)\n      // formData.append('moduleName', 'selle')\n\n      // uploadimg(formData).then((data) => {\n      //   Toast.clear()\n      //   this.ruleForm.sellerImg = data\n      // })\n    },\n    //文件上传\n    afterRead2(file) {\n      _Toast.loading({\n        duration: 0,\n        message: this.$t('上传中'),\n        forbidClick: true\n      });\n      let formData = new FormData(); //通过formdata上传\n      formData.append('file', file.file);\n      formData.append('moduleName', 'selle');\n      uploadimg(formData).then(data => {\n        this.ruleForm.idimg_1 = data;\n      }).catch(error => {\n        this.fileList2 = [];\n        _Toast.fail(this.$t('上传失败'));\n      }).finally(() => {\n        _Toast.clear();\n      });\n    },\n    //文件上传\n    afterRead3(file) {\n      _Toast.loading({\n        duration: 0,\n        message: this.$t('上传中'),\n        forbidClick: true\n      });\n      let formData = new FormData(); //通过formdata上传\n      formData.append('file', file.file);\n      formData.append('moduleName', 'selle');\n      uploadimg(formData).then(data => {\n        this.ruleForm.idimg_2 = data;\n      }).catch(error => {\n        this.fileList3 = [];\n        _Toast.fail(this.$t('上传失败'));\n      }).finally(() => {\n        _Toast.clear();\n      });\n    },\n    //文件上传\n    afterRead4(file) {\n      _Toast.loading({\n        duration: 0,\n        message: this.$t('上传中'),\n        forbidClick: true\n      });\n      let formData = new FormData(); //通过formdata上传\n      formData.append('file', file.file);\n      formData.append('moduleName', 'selle');\n      uploadimg(formData).then(data => {\n        this.ruleForm.idimg_3 = data;\n      }).catch(error => {\n        this.fileList4 = [];\n        _Toast.fail(this.$t('上传失败'));\n      }).finally(() => {\n        _Toast.clear();\n      });\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}