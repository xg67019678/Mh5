{"ast":null,"code":"import \"vant/es/empty/style\";\nimport _Empty from \"vant/es/empty\";\nimport \"vant/es/rate/style\";\nimport _Rate from \"vant/es/rate\";\nimport \"vant/es/cell-group/style\";\nimport _CellGroup from \"vant/es/cell-group\";\nimport \"vant/es/field/style\";\nimport _Field from \"vant/es/field\";\nimport \"vant/es/tabs/style\";\nimport _Tabs from \"vant/es/tabs\";\nimport \"vant/es/tab/style\";\nimport _Tab from \"vant/es/tab\";\nimport \"vant/es/popup/style\";\nimport _popup from \"vant/es/popup\";\nimport \"vant/es/picker/style\";\nimport _Picker from \"vant/es/picker\";\nimport \"vant/es/icon/style\";\nimport _Icon from \"vant/es/icon\";\nimport \"vant/es/pull-refresh/style\";\nimport _PullRefresh from \"vant/es/pull-refresh\";\nimport \"vant/es/list/style\";\nimport _List from \"vant/es/list\";\nimport \"vant/es/nav-bar/style\";\nimport _NavBar from \"vant/es/nav-bar\";\nimport \"vant/es/image-preview/style\";\nimport _ImagePreview from \"vant/es/image-preview\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { getEvaluationList, apiEvaluationCountType } from \"@/API/commodity\";\nimport { getStorage, formatZoneDate } from \"@/utils/utis\";\nexport default {\n  data() {\n    return {\n      formatZoneDate,\n      itemName: process.env.VUE_APP_ITEM_NAME,\n      mainColor: process.env.VUE_APP_MAIN_COLOR,\n      sort_index: '',\n      list: [],\n      page_no: 0,\n      refreshing: false,\n      loading: false,\n      finished: false,\n      evaluationNum: 0,\n      defaultAvatar: require('@/assets/image/default_avatar.png'),\n      havePicture: '0',\n      mediumReview: '0',\n      negativeComment: '0',\n      positiveComments: '0',\n      ImagePreview: _ImagePreview,\n      isEn: getStorage('lang') == 'en'\n    };\n  },\n  components: {\n    [_NavBar.name]: _NavBar,\n    [_List.name]: _List,\n    [_PullRefresh.name]: _PullRefresh,\n    [_Icon.name]: _Icon,\n    [_Picker.name]: _Picker,\n    [_popup.name]: _popup,\n    [_Tab.name]: _Tab,\n    [_Tabs.name]: _Tabs,\n    [_Field.name]: _Field,\n    [_CellGroup.name]: _CellGroup,\n    [_Rate.name]: _Rate,\n    [_Empty.name]: _Empty\n  },\n  created() {\n    this.list = [\n      // {createTime:'12:00',content:132,rating:3.5,partyName:'娃哈哈哈哈哈'}\n    ];\n    // 获取中评差评数量\n    apiEvaluationCountType({\n      goodId: this.$route.query.sellerGoodsId\n    }).then(res => {\n      const {\n        havePicture,\n        mediumReview,\n        negativeComment,\n        positiveComments\n      } = res;\n      this.havePicture = havePicture;\n      this.mediumReview = mediumReview;\n      this.negativeComment = negativeComment;\n      this.positiveComments = positiveComments;\n    });\n    this.getList();\n  },\n  methods: {\n    handleList(item) {\n      const arr = [];\n      Object.keys(item).forEach(key => {\n        if (key.indexOf('imgUrl') !== -1 && item[key]) {\n          arr.push(item[key]);\n        }\n      });\n      return arr;\n    },\n    getList() {\n      this.page_no++;\n      let dataJson = {\n        sellerGoodsId: this.$route.query.sellerGoodsId,\n        pageNum: this.page_no,\n        pageSize: 10,\n        evaluationType: this.sort_index\n      };\n      getEvaluationList(dataJson).then(res => {\n        this.evaluationNum = res.evaluationNum;\n        for (let i = 0; i < res.pageList.length; i++) {\n          this.list.push(res.pageList[i]);\n        }\n        this.list = this.list.map(item => {\n          const images = [item.imgUrl1, item.imgUrl2, item.imgUrl3, item.imgUrl4, item.imgUrl5, item.imgUrl6, item.imgUrl7, item.imgUrl8, item.imgUrl9];\n          return {\n            ...item,\n            images: images.filter(url => !!url)\n          };\n        });\n        this.loading = false;\n        if (res.pageList.length == 0) {\n          this.finished = true;\n        }\n      });\n    },\n    onRefresh() {\n      // 清空列表数据\n      this.finished = false;\n      this.page_no = 0;\n      // 重新加载数据\n      // 将 loading 设置为 true，表示处于加载状态\n      this.loading = true;\n      this.onLoad();\n    },\n    onLoad() {\n      if (this.refreshing) {\n        this.list = [];\n        this.refreshing = false;\n      }\n      this.getList();\n    },\n    onClickLeft() {\n      this.$router.go(-1);\n    }\n  },\n  watch: {\n    sort_index() {\n      this.list = [];\n      this.page_no = 0;\n      this.getList();\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}